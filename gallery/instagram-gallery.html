<dom-module is="instagram-gallery">
    <style is="custom-style">
        :host {
            display: block;
            width: 100%;
            padding-bottom: 5vh;
            margin-left: auto;
            margin-right: auto;
        }
        :host::content a {
          display: block;

          @apply(--layout-flex);
          margin-bottom: 2vh;
          width: 150px;
        }
        :host::content img {
          display: block;

          width: 150px;

        }
        #instagram {
          @apply(--layout-horizontal);
          @apply(--layout-wrap);
        }
    </style>
    <template>
          <div id="instagram"></div>
          <iron-scroll-threshold scroll-target="[[scrollTarget]]" on-lower-threshold="loadNext">
        </iron-scroll-threshold>
    </template>
</dom-module>
<script>
    Polymer({
        is: "instagram-gallery",
        ready: function() {
            this.scrollTarget = document.querySelector('html');

        },
        loadNext: function(e) {
          var scrollThreshold = this.$$('iron-scroll-threshold');
            console.log(e)
            if (this.userFeed && this.userFeed.hasNext()) {
                this.userFeed.next();
            }
            if (!this.userFeed){
              this.userFeed = new Instafeed({
                  get: "user",
                  userId: '253291627',
                  accessToken: '253291627.1677ed0.45b8d7466847441b9a798f77585995e8',
                  target: 'instagram',
                  resolution: 'thumbnail',
                  after: function(){
                    scrollThreshold.clearTriggers()
                  }
              })
              this.userFeed.run()
            }
        }

    })
</script>
